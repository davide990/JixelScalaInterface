package RabbitMQ.Launchers.MUSA

import RabbitMQ.Producer.MUSARabbitMQProducer
import RabbitMQ.Serializer.JixelEventJsonSerializer
import RabbitMQ._

object MusaRabbitMQClient {

  //val event = JixelEvent("12343", "incendio")
  //val event2 = JixelEvent("56789", "incendio2")

  //val eventUpdate = JixelEventUpdate(event, JixelEventUpdateDetail(JixelEventUpdateTypology.EventDescription, "blabla"))
  //val eventReport = JixelEventReport(event, List(JixelEventReportFileAttachments("file1", "file.doc")))
  //val eventUpdateJSon = "{ \"event\":{     \"id\":\"69\",     \"incident_msgtype\":{       \"id\":2,       \"enum_value\":\"Informativa (Notifiche disattivate)\",       \"description_name\":\"Tipo di comunicazione evento\",       \"description_value\":\"Informativa (Notifiche disattivate)\",       \"description_category\":\"Evento\",       \"additional_parameters\":[],       \"cap_description_value\":\"Information\"     },     \"incident_type\":{       \"id\":13,       \"description\":\"Altro\",       \"color\":null,       \"icon\":null,       \"app_enabled\":false,       \"order\":null,       \"deleted\":null,       \"default_value\":true,       \"category\":\"\",       \"interoperability_incident_type_id\":null,       \"post_emergency\":0,       \"description_name\":\"Tipologia evento\",       \"description_value\":\"Altro\",       \"description_category\":\"Evento\",       \"additional_parameters\":[],       \"subtypes\":\"\",       \"cap_type_description\":null     },     \"incident_status\":{       \"id\":1,       \"description\":\"Segnalazione\",       \"description_name\":\"Stato evento\",       \"description_value\":\"Segnalazione\",       \"description_category\":\"Evento\",       \"additional_parameters\":[]     },     \"incident_urgency\":null,     \"incident_severity\":null,     \"headline\":\"test\",     \"description\":\"test\",     \"caller_name\":\"\",     \"caller_phone\":\"\",     \"instructions\":null,     \"locations\":[],     \"controllable_object\":{       \"id\":1104,       \"created\":\"2022-05-18T13:07:42+0200\",       \"modified\":\"2022-07-05T15:55:16+0200\",       \"organisation_id\":1,       \"controllable_object_type_id\":1,       \"last_activity_entry_id\":363,       \"check_code\":\"84780243d835906df878b50b8a0354dc\",       \"emergency_scenario_id\":null,       \"emergency_scenario_activity\":0,       \"create_user_id\":51,       \"edit_user_id\":51,       \"edit_organisation_id\":1,       \"deleted\":null,       \"locations\":[         {           \"id\":380,           \"description\":\"Rieti, Lazio\",           \"geotype\":\"marker\",           \"coordinates\":\"12.94189 42.4883\",           \"is_strategic_positions\":null,           \"code\":null,           \"controllable_object_id\":1104,           \"feature_collection\":null,           \"road\":\"\",           \"town\":\"\",           \"county\":\"\",           \"postcode\":\"\",           \"state\":\"\",           \"country\":\"\",           \"loggable_object_id\":463,           \"coordinates_ne\":\"42.4883 12.94189\",           \"latitude\":\"42.4883\",           \"longitude\":\"12.94189\"         }       ],       \"additional_parameter_value\":[],       \"creator_with_organisation\":\"Giovanni Francesco Luigi Catania (iessolutions)\",       \"additional_parameters\":[],       \"additional_parameters_for_list\":[],       \"attachment_file_names\":{         \"list\":[]       },       \"attachment_url_accesses\":{         \"list\":[]       },       \"creator_organisation\":\"iessolutions - iessolutions\"     },     \"recipients\":[       {         \"group_name\":\"Organizzazione\",         \"group_items\":[           {             \"id\":1,             \"text\":\"iessolutions\"           },           {             \"id\":115,             \"text\":\"Istituto di Calcolo e Reti ad Alte Prestazioni\"           }         ]       }     ],     \"voluntary_organisations\":[]   },   \"update\":{     \"updateType\":3,     \"content\":\"my description\"   } }"

  val testEvent2 = "{\"id\":3750,\"description\":\"Test MUSA\",\"casualties\":null,\"caller_name\":null,\"caller_phone\":null,\"incident_interface_fire\":false,\"incident_distance\":null,\"controllable_object_id\":74396,\"incident_msgtype_id\":1,\"incident_type_id\":6,\"incident_status_id\":2,\"incident_loctype_id\":null,\"incident_category_id\":null,\"incident_env_id\":null,\"incident_actor_id\":null,\"incident_urgency_id\":1,\"incident_severity_id\":1,\"incident_id\":null,\"incident_subtype_id\":null,\"headline\":\"tutto ok\",\"date\":\"2022-10-07T16:52:07+0200\",\"completable\":false,\"public\":true,\"incidents_value\":null,\"references_value\":null,\"external\":null,\"expires\":null,\"previuos_identifier\":null,\"mjixel_thread\":null,\"mjixel_activity\":null,\"incident_response_type_id\":null,\"on_set\":null,\"controllable_object\":{\"id\":74396,\"created\":\"2022-10-07T16:52:07+0200\",\"modified\":\"2022-10-10T14:49:31+0200\",\"organisation_id\":\"2242\",\"controllable_object_type_id\":1,\"last_activity_entry_id\":16298,\"check_code\":\"da399d79483da91342bd392c15f4b736\",\"emergency_scenario_id\":\"\",\"emergency_scenario_activity\":0,\"create_user_id\":9,\"edit_user_id\":9,\"edit_organisation_id\":2242,\"deleted\":null,\"voluntary_organisations\":[[\"34\",\"28\"]],\"location\":{\"id\":56447,\"description\":\"13.85143595181 37.699417616361\",\"geotype\":\"marker\",\"coordinates\":\"13.85144 37.69942\",\"is_strategic_positions\":null,\"code\":null,\"controllable_object_id\":74396,\"feature_collection\":\"{\\\"type\\\":\\\"FeatureCollection\\\",\\\"features\\\":[{\\\"type\\\":\\\"Feature\\\",\\\"properties\\\":{},\\\"geometry\\\":{\\\"type\\\":\\\"Polygon\\\",\\\"coordinates\\\":[[[14.67541056107,37.333425811526],[14.873164467292,37.542783797629],[14.664424232946,37.586326291179],[14.67541056107,37.333425811526]]]}}]}\",\"road\":\"\",\"town\":\"\",\"county\":\"\",\"postcode\":\"\",\"state\":\"\",\"country\":\"\",\"loggable_object_id\":23108,\"coordinates_ne\":\"37.69942 13.85144\",\"latitude\":\"37.69942\",\"longitude\":\"13.85144\"},\"modifier\":{\"id\":9,\"organisation_id\":2242,\"username\":\"giovannict73\",\"surname\":\"Catania\",\"name\":\"Giovanni Francesco\",\"address\":\"AAABBBCCCCDDDOKXOK\",\"city\":\"Catania1XY\",\"cap\":\"951231XY\",\"phone\":\"\",\"mobile\":\"3333236751 (Personale), 00393333236751 (Personale), 1 (Personale)\",\"mobile2\":\"\",\"email\":\"g.catania@i4es.it (Ufficio)\",\"tax_code\":\"CTNGNN73E31C351Z\",\"photo\":\"20160511100024b11c952018d503bad04e366a662f5243.jpg\",\"birthplace\":\"Catania\",\"birthday\":\"1973-05-31T00:00:00+0100\",\"notification_hash\":\"b93bc99530a0192733a2a825202cb035\",\"fax\":\"\",\"gender\":\"M\",\"pathologies\":\"PATOXOKXY\",\"allergies\":\"1211999XOKXY\",\"food_intolerances\":\"21999XOKXY\",\"medical_certifications\":\"31999XOKXY\",\"relatives\":\"4999XOKXY\",\"change_password\":false,\"blood_group\":\"AB-OKXY123s\",\"last_login\":\"2022-10-10T10:13:39+0200\",\"last_registered_request\":\"2020-04-30T10:05:50+0200\",\"from_mobile\":false,\"last_ip_address\":\"192.168.212.12\",\"language_id\":null,\"position_date\":\"2020-08-31T17:04:15+0200\",\"privacy\":true,\"conditions\":true,\"password_recovery_token\":\"409b645c69d52d075cee8914ede68cb207c606bf\",\"last_change_password\":\"2019-09-20T08:59:10+0200\",\"password_recovery_counter\":1,\"email2\":\"\",\"actor_id\":2067,\"ambiguity_verified\":false,\"invalid_login_date\":null,\"invalid_login_count\":0,\"deleted\":null,\"loggable_object_id\":76,\"is_device\":null,\"device_description\":null,\"voip_extension\":\"301\",\"organisation\":{\"id\":2242,\"acronym\":\"IES\",\"address\":\"Via Magna Grecia, Canalicchio, Tremestieri Etneo, Catania, Sicilia, 95030, Italia\",\"district\":\"Tremestieri Etneo\",\"cap\":\"\",\"province\":\"\",\"phone\":\"\",\"mobile\":\"3405681233 (Personale), 3405681234 (Personale)\",\"fax\":\"095355980 (Ufficio), 095355981 (Ufficio)\",\"email\":\"mailsenzanotifica@gmail.com (Ufficio), mailconnotifica@gmail.com (Ufficio)\",\"organisation_type_id\":0,\"actor_id\":6681,\"incident_creator\":false,\"pec\":\"\",\"geotype\":\"marker\",\"coordinates\":\"15.0990811 37.5397058\",\"feature_collection\":null,\"deleted\":null,\"photo\":null,\"incident_default_tab\":-3,\"loggable_object_id\":15119,\"controllable_object_interface_id\":1118,\"allow_badges\":false,\"actor\":{\"id\":6681,\"description\":\"IES Solutions SRL\",\"actor_type_id\":1,\"interoperability_identifier\":null,\"incident_type_group_id\":null,\"deleted\":null,\"description_with_actor_type\":\"IES Solutions SRL (Organisation)\",\"actor_type_description\":\"Organisation\"}},\"email2_wd\":null,\"full_name\":\"Giovanni Francesco Catania\",\"validTaxCode\":1},\"creator\":{\"id\":9,\"organisation_id\":2242,\"username\":\"giovannict73\",\"surname\":\"Catania\",\"name\":\"Giovanni Francesco\",\"address\":\"AAABBBCCCCDDDOKXOK\",\"city\":\"Catania1XY\",\"cap\":\"951231XY\",\"phone\":\"\",\"mobile\":\"3333236751 (Personale), 00393333236751 (Personale), 1 (Personale)\",\"mobile2\":\"\",\"email\":\"g.catania@i4es.it (Ufficio)\",\"tax_code\":\"CTNGNN73E31C351Z\",\"photo\":\"20160511100024b11c952018d503bad04e366a662f5243.jpg\",\"birthplace\":\"Catania\",\"birthday\":\"1973-05-31T00:00:00+0100\",\"notification_hash\":\"b93bc99530a0192733a2a825202cb035\",\"fax\":\"\",\"gender\":\"M\",\"pathologies\":\"PATOXOKXY\",\"allergies\":\"1211999XOKXY\",\"food_intolerances\":\"21999XOKXY\",\"medical_certifications\":\"31999XOKXY\",\"relatives\":\"4999XOKXY\",\"change_password\":false,\"blood_group\":\"AB-OKXY123s\",\"last_login\":\"2022-10-10T10:13:39+0200\",\"last_registered_request\":\"2020-04-30T10:05:50+0200\",\"from_mobile\":false,\"last_ip_address\":\"192.168.212.12\",\"language_id\":null,\"position_date\":\"2020-08-31T17:04:15+0200\",\"privacy\":true,\"conditions\":true,\"password_recovery_token\":\"409b645c69d52d075cee8914ede68cb207c606bf\",\"last_change_password\":\"2019-09-20T08:59:10+0200\",\"password_recovery_counter\":1,\"email2\":\"\",\"actor_id\":2067,\"ambiguity_verified\":false,\"invalid_login_date\":null,\"invalid_login_count\":0,\"deleted\":null,\"loggable_object_id\":76,\"is_device\":null,\"device_description\":null,\"voip_extension\":\"301\",\"organisation\":{\"id\":2242,\"acronym\":\"IES\",\"address\":\"Via Magna Grecia, Canalicchio, Tremestieri Etneo, Catania, Sicilia, 95030, Italia\",\"district\":\"Tremestieri Etneo\",\"cap\":\"\",\"province\":\"\",\"phone\":\"\",\"mobile\":\"3405681233 (Personale), 3405681234 (Personale)\",\"fax\":\"095355980 (Ufficio), 095355981 (Ufficio)\",\"email\":\"mailsenzanotifica@gmail.com (Ufficio), mailconnotifica@gmail.com (Ufficio)\",\"organisation_type_id\":0,\"actor_id\":6681,\"incident_creator\":false,\"pec\":\"\",\"geotype\":\"marker\",\"coordinates\":\"15.0990811 37.5397058\",\"feature_collection\":null,\"deleted\":null,\"photo\":null,\"incident_default_tab\":-3,\"loggable_object_id\":15119,\"controllable_object_interface_id\":1118,\"allow_badges\":false,\"actor\":{\"id\":6681,\"description\":\"IES Solutions SRL\",\"actor_type_id\":1,\"interoperability_identifier\":null,\"incident_type_group_id\":null,\"deleted\":null,\"description_with_actor_type\":\"IES Solutions SRL (Organisation)\",\"actor_type_description\":\"Organisation\"}},\"email2_wd\":null,\"full_name\":\"Giovanni Francesco Catania\",\"validTaxCode\":1},\"organisation\":{\"id\":2242,\"acronym\":\"IES\",\"address\":\"Via Magna Grecia, Canalicchio, Tremestieri Etneo, Catania, Sicilia, 95030, Italia\",\"district\":\"Tremestieri Etneo\",\"cap\":\"\",\"province\":\"\",\"phone\":\"\",\"mobile\":\"3405681233 (Personale), 3405681234 (Personale)\",\"fax\":\"095355980 (Ufficio), 095355981 (Ufficio)\",\"email\":\"mailsenzanotifica@gmail.com (Ufficio), mailconnotifica@gmail.com (Ufficio)\",\"organisation_type_id\":0,\"actor_id\":6681,\"incident_creator\":false,\"pec\":\"\",\"geotype\":\"marker\",\"coordinates\":\"15.0990811 37.5397058\",\"feature_collection\":null,\"deleted\":null,\"photo\":null,\"incident_default_tab\":-3,\"loggable_object_id\":15119,\"controllable_object_interface_id\":1118,\"allow_badges\":false,\"actor\":{\"id\":6681,\"description\":\"IES Solutions SRL\",\"actor_type_id\":1,\"interoperability_identifier\":null,\"incident_type_group_id\":null,\"deleted\":null,\"description_with_actor_type\":\"IES Solutions SRL (Organisation)\",\"actor_type_description\":\"Organisation\"}},\"skipCOB\":true,\"skipAfterSave\":true,\"additional_parameter_value\":[],\"creator_with_organisation\":\"Giovanni Francesco Catania (IES Solutions SRL)\",\"additional_parameters\":[\"URL Esterno: url link...\",\"Istituzione COC: YES\"],\"additional_parameters_for_list\":[\"URL Esterno: url link...\",\"Istituzione COC: YES\"],\"attachment_file_names\":[],\"attachment_url_accesses\":[],\"creator_organisation\":\"IES - IES Solutions SRL\"},\"abstract_resources\":[],\"address\":\"13.85143595181 37.699417616361\",\"longitude\":\"13.85144\",\"latitude\":\"37.69942\",\"area\":\"{\\\"type\\\":\\\"FeatureCollection\\\",\\\"features\\\":[{\\\"type\\\":\\\"Feature\\\",\\\"properties\\\":{},\\\"geometry\\\":{\\\"type\\\":\\\"Polygon\\\",\\\"coordinates\\\":[[[14.67541056107,37.333425811526],[14.873164467292,37.542783797629],[14.664424232946,37.586326291179],[14.67541056107,37.333425811526]]]}}]}\",\"incident_instructions\":[],\"entity_type\":\"Event\",\"entity_url\":\"\\/incidents\\/view\\/3750\",\"entity_description\":\"3750 - tutto ok\",\"instructions\":null}"

  // evento mandato da gianfranco, 12/10/2022
  val testEvent3="{\n    \"id\": 3759,\n    \"description\": \"TEST MUSA DESC LIKE API OK\",\n    \"casualties\": null,\n    \"caller_name\": \"\",\n    \"caller_phone\": \"\",\n    \"incident_interface_fire\": false,\n    \"incident_distance\": null,\n    \"incident_msgtype_id\": 1,\n    \"incident_type_id\": 12,\n    \"incident_status_id\": 2,\n    \"incident_id\": 3758,\n    \"headline\": \"TEST MUSA HEADLINE\",\n    \"date\": \"2022-10-11T10:59:07+0200\",\n    \"completable\": false,\n    \"public\": false,\n    \"controllable_object\": {\n      \"id\": 74434,\n      \"created\": \"2022-10-11T10:59:07+0200\",\n      \"modified\": \"2022-10-11T14:45:43+0200\",\n      \"organisation_id\": 2242,\n      \"controllable_object_type_id\": 1,\n      \"last_activity_entry_id\": 16309,\n      \"check_code\": \"e431e7cf7d36c4cb944c94680947e5b1\",\n      \"emergency_scenario_id\": null,\n      \"emergency_scenario_activity\": 0,\n      \"create_user_id\": 9,\n      \"edit_user_id\": 9,\n      \"edit_organisation_id\": 2242,\n      \"deleted\": null,\n      \"organisation\": {\n        \"id\": 2242,\n        \"acronym\": \"IES\",\n        \"address\": \"Via Magna Grecia, Canalicchio, Tremestieri Etneo, Catania, Sicilia, 95030, Italia\",\n        \"district\": \"Tremestieri Etneo\",\n        \"cap\": \"\",\n        \"province\": \"\",\n        \"phone\": \"\",\n        \"mobile\": \"3405681233 (Personale), 3405681234 (Personale)\",\n        \"fax\": \"095355980 (Ufficio), 095355981 (Ufficio)\",\n        \"email\": \"mailsenzanotifica@gmail.com (Ufficio), mailconnotifica@gmail.com (Ufficio)\",\n        \"organisation_type_id\": 0,\n        \"actor_id\": 6681,\n        \"incident_creator\": false,\n        \"pec\": \"\",\n        \"geotype\": \"marker\",\n        \"coordinates\": \"15.0990811 37.5397058\",\n        \"feature_collection\": null,\n        \"deleted\": null,\n        \"photo\": null,\n        \"incident_default_tab\": -3,\n        \"loggable_object_id\": 15119,\n        \"controllable_object_interface_id\": 1118,\n        \"allow_badges\": false,\n        \"actor\": {\n          \"id\": 6681,\n          \"description\": \"IES Solutions SRL\",\n          \"actor_type_id\": 1,\n          \"interoperability_identifier\": null,\n          \"incident_type_group_id\": null,\n          \"deleted\": null,\n          \"description_with_actor_type\": \"IES Solutions SRL (Organizzazione)\",\n          \"actor_type_description\": \"Organizzazione\"\n        }\n      },\n      \"read\": 0,\n      \"received\": 0,\n      \"additional_parameter_value\": [],\n      \"creator_with_organisation\": \"Giovanni Francesco Catania (IES Solutions SRL)\",\n      \"additional_parameters\": [],\n      \"additional_parameters_for_list\": [],\n      \"attachment_file_names\": [],\n      \"attachment_url_accesses\": [],\n      \"creator_organisation\": \"IES - IES Solutions SRL\"\n    },\n    \"incident_status\": {\n      \"id\": 2,\n      \"description\": \"In Attesa/Accertamento\",\n      \"description_name\": \"Stato evento\",\n      \"description_value\": \"In Attesa/Accertamento\",\n      \"description_category\": \"Evento\",\n      \"additional_parameters\": []\n    },\n    \"incident_msgtype\": {\n      \"id\": 1,\n      \"enum_value\": \"Operativa\",\n      \"description_name\": \"Tipo di comunicazione evento\",\n      \"description_value\": \"Operativa\",\n      \"description_category\": \"Evento\",\n      \"additional_parameters\": [],\n      \"cap_description_value\": \"Request\"\n    },\n    \"_matchingData\": {\n      \"ControllableObjects\": {\n        \"id\": 74434,\n        \"created\": \"2022-10-11T10:59:07+0200\",\n        \"modified\": \"2022-10-11T14:45:43+0200\",\n        \"organisation_id\": 2242,\n        \"controllable_object_type_id\": 1,\n        \"last_activity_entry_id\": 16309,\n        \"check_code\": \"e431e7cf7d36c4cb944c94680947e5b1\",\n        \"emergency_scenario_id\": null,\n        \"emergency_scenario_activity\": 0,\n        \"create_user_id\": 9,\n        \"edit_user_id\": 9,\n        \"edit_organisation_id\": 2242,\n        \"deleted\": null,\n        \"additional_parameter_value\": [],\n        \"creator_with_organisation\": \"Giovanni Francesco Catania (IES Solutions SRL)\",\n        \"additional_parameters\": [],\n        \"additional_parameters_for_list\": [],\n        \"attachment_file_names\": [],\n        \"attachment_url_accesses\": [],\n        \"creator_organisation\": \"IES - IES Solutions SRL\"\n      },\n      \"ControllableObjectActors\": {\n        \"id\": 126416,\n        \"controllable_object_id\": 74434,\n        \"actor_id\": 6681,\n        \"controllable_object_actor_type_id\": 1,\n        \"validation_level_id\": null,\n        \"deleted\": null\n      },\n      \"Organisations\": {\n        \"id\": 2242,\n        \"acronym\": \"IES\",\n        \"address\": \"Via Magna Grecia, Canalicchio, Tremestieri Etneo, Catania, Sicilia, 95030, Italia\",\n        \"district\": \"Tremestieri Etneo\",\n        \"cap\": \"\",\n        \"province\": \"\",\n        \"phone\": \"\",\n        \"mobile\": \"3405681233 (Personale), 3405681234 (Personale)\",\n        \"fax\": \"095355980 (Ufficio), 095355981 (Ufficio)\",\n        \"email\": \"mailsenzanotifica@gmail.com (Ufficio), mailconnotifica@gmail.com (Ufficio)\",\n        \"organisation_type_id\": 0,\n        \"actor_id\": 6681,\n        \"incident_creator\": false,\n        \"pec\": \"\",\n        \"geotype\": \"marker\",\n        \"coordinates\": \"15.0990811 37.5397058\",\n        \"feature_collection\": null,\n        \"deleted\": null,\n        \"photo\": null,\n        \"incident_default_tab\": -3,\n        \"loggable_object_id\": 15119,\n        \"controllable_object_interface_id\": 1118,\n        \"allow_badges\": false\n      },\n      \"Actors\": {\n        \"id\": 6681,\n        \"description\": \"IES Solutions SRL\",\n        \"actor_type_id\": 1,\n        \"interoperability_identifier\": null,\n        \"incident_type_group_id\": null,\n        \"deleted\": null,\n        \"description_with_actor_type\": \"IES Solutions SRL (Organizzazione)\",\n        \"actor_type_description\": \"Organizzazione\"\n      }\n    },\n    \"is_user_recipient\": true,\n    \"updates\": 2,\n    \"entity_type\": \"Evento\",\n    \"entity_description\": \"3759 - TEST MUSA HEADLINE\",\n    \"instructions\": null\n  }"

  var MUSA: MUSARabbitMQProducer = null

  def main(argv: Array[String]) {

    val parsedJixelEvent = JixelEventJsonSerializer.fromJson(testEvent3)

    var response: String = null
    try {
      MUSA = new MUSARabbitMQProducer
      //Notify event
      println(" [x] notifying event")
      response = MUSA.notifyEvent(null)
      println(" [.] Got '" + response + "' from MUSA")
      Thread.sleep(1000)
    } catch {
      case e: Exception => e.printStackTrace()
    } finally {
      if (MUSA == null)
        return;

      try {
        MUSA.close()
      } catch {
        case _: Exception =>
      }
    }
  }


}
